(this["webpackJsonpmesto-react-app"]=this["webpackJsonpmesto-react-app"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(20),i=n.n(s),o=(n(29),n(22)),r=n(2),u=n.p+"static/media/header_logo_theme_dark.9acae848.svg",l=n(8),p=n(3),d=n(0);var j=function(e){var t=c.a.useState(!1),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(d.jsxs)("div",{className:a?"header__wrapper":"header__wrapper header__wrapper_hidden",children:[Object(d.jsx)("span",{className:"header__title",children:e.email}),Object(d.jsx)(l.b,{className:"link header__wrapper-link",onClick:function(){e.handleLogOut(),s(!1)},to:"/sign-in",children:"\u0412\u044b\u0439\u0442\u0438"})]});return Object(d.jsxs)("div",{className:"header",children:[Object(d.jsx)("img",{className:"header__logo",src:u,alt:"\u041c\u0415\u0421\u0422\u041e"}),Object(d.jsxs)(p.d,{children:[Object(d.jsxs)(p.b,{exact:!0,path:"/",children:[i,Object(d.jsx)("div",{className:"header__nav",children:Object(d.jsx)("button",{className:"button button__burger-menu",onClick:function(e){e.target.classList.toggle("button__close"),e.target.classList.toggle("button__burger-menu"),s(!a)}})})]}),Object(d.jsx)(p.b,{exact:!0,path:"/sign-in",children:Object(d.jsx)(l.b,{to:"/sign-up",className:"link header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(d.jsx)(p.b,{exact:!0,path:"/sign-up",children:Object(d.jsx)(l.b,{to:"/sign-in",className:"link header__link",children:"\u0412\u043e\u0439\u0442\u0438"})})]})]})},h=c.a.createContext();var b=function(e){var t=Object(a.useContext)(h),n=e.card.owner._id===t._id,c="card__delete ".concat(n?"card__delete_visible":"card__delete_hidden"),s=e.card.likes.some((function(e){return e._id===t._id}));return Object(d.jsx)("div",{className:"card-template",children:Object(d.jsxs)("li",{className:"card",children:[Object(d.jsx)("button",{className:"button ".concat(c),type:"button",onClick:function(){e.onCardDelete(e.card)}}),Object(d.jsx)("img",{className:"card__image",src:e.link,alt:e.name,onClick:function(){e.onCardClick(e.card)}}),Object(d.jsxs)("div",{className:"card__text",children:[Object(d.jsx)("h2",{className:"card__title",children:e.name}),Object(d.jsxs)("div",{className:"card__like-wrapper",children:[Object(d.jsx)("button",{className:"button card__like ".concat(s?"card__like_active":""),type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(d.jsx)("span",{className:"card__like-counter",children:e.likes.length})]})]})]})})};var _=function(e){var t=Object(a.useContext)(h);return Object(d.jsxs)("main",{className:"content",children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsx)("div",{className:"profile__avatar-wrapper",style:{backgroundImage:"url(".concat(t.avatar,")")},children:Object(d.jsx)("button",{className:"button profile__edit-image",onClick:e.onEditAvatar})}),Object(d.jsxs)("div",{className:"profile__wrapper",children:[Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsx)("h1",{className:"profile__info-title",children:t.name}),Object(d.jsx)("p",{className:"profile__info-text",children:t.about})]}),Object(d.jsx)("button",{className:"button profile__edit",type:"button",onClick:e.onEditProfile})]}),Object(d.jsx)("button",{className:"button profile__add",type:"button",onClick:e.onAddPlace})]}),Object(d.jsx)("section",{children:Object(d.jsx)("ul",{className:"cards",children:e.cards.map((function(t){return Object(d.jsx)(b,{name:t.name,link:t.link,likes:t.likes,id:t._id,onCardClick:e.onCardClick,card:t,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})};var m=function(){return Object(d.jsx)(p.d,{children:Object(d.jsx)(p.b,{exact:!0,path:"/",children:Object(d.jsx)("footer",{className:"footer",children:Object(d.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})})})};var O=function(e){return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_display_active"):"popup popup_type_".concat(e.name),children:Object(d.jsxs)("div",{className:"popup__window",children:[Object(d.jsx)("h2",{className:"popup__title",children:e.title}),Object(d.jsx)("form",{className:"popup__form",name:e.name,noValidate:!0,onSubmit:e.onSubmit,children:e.children}),Object(d.jsx)("button",{className:"button button__close popup__close",type:"button",onClick:function(){e.onClose()}})]})})})};var f=function(e){var t=Object(a.useState)(""),n=Object(r.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(""),o=Object(r.a)(i,2),u=o[0],l=o[1],p=Object(a.useContext)(h);return Object(a.useEffect)((function(){s(p.name),l(p.about)}),[p]),Object(d.jsxs)(O,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:u})},children:[Object(d.jsx)("input",{className:"popup__input popup__input_profile_name",type:"text",name:"name",minLength:"2",maxLength:"40",required:!0,value:c,onChange:function(e){s(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error profile-name-error"}),Object(d.jsx)("input",{className:"popup__input popup__input_profile_job",type:"text",name:"about",minLength:"2",maxLength:"200",required:!0,value:u,onChange:function(e){l(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error profile-text-error"}),Object(d.jsx)("button",{className:"button popup__submit",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var v=function(e){return Object(d.jsx)("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_display_active"):"popup popup_type_".concat(e.name),children:Object(d.jsxs)("div",{className:"popup__image-viewer",children:[Object(d.jsx)("img",{className:"popup__image",src:e.link,alt:e.name}),Object(d.jsx)("p",{className:"popup__caption",children:e.name}),Object(d.jsx)("button",{className:"button button__close popup__close",type:"button",onClick:e.onClose})]})})},x=n(13),g=n(14),k=new(function(){function e(t){var n=t.url,a=t.token,c=t.cohortId;Object(x.a)(this,e),this._url=n,this._token=a,this._cohortId=c}return Object(g.a)(e,[{key:"_getResponseStatus",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url).concat(this._cohortId,"/cards"),{method:"GET",headers:{authorization:this._token}}).then((function(t){return e._getResponseStatus(t)}))}},{key:"addNewCard",value:function(e){var t=this,n=e.name,a=e.link;return fetch("".concat(this._url).concat(this._cohortId,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:n,link:a})}).then((function(e){return t._getResponseStatus(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url).concat(this._cohortId,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._getResponseStatus(e)}))}},{key:"addLike",value:function(e){var t=this;return fetch("".concat(this._url).concat(this._cohortId,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._getResponseStatus(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch("".concat(this._url).concat(this._cohortId,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._getResponseStatus(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.addLike(e):this.removeLike(e)}},{key:"getUserInformation",value:function(){var e=this;return fetch("".concat(this._url).concat(this._cohortId,"/users/me"),{headers:{method:"GET",authorization:this._token}}).then((function(t){return e._getResponseStatus(t)}))}},{key:"saveUserInformation",value:function(e){var t=this,n=e.name,a=e.about;return fetch("".concat(this._url).concat(this._cohortId,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:n,about:a})}).then((function(e){return t._getResponseStatus(e)}))}},{key:"changeUserAvatar",value:function(e){var t=this;return fetch("".concat(this._url).concat(this._cohortId,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseStatus(e)}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/",token:"7f507e56-179e-4a59-8e89-b0f615ca62d2",cohortId:"cohort-20"});var N=function(e){var t=Object(a.useRef)();return Object(d.jsxs)(O,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(d.jsx)("input",{className:"popup__input popup__input_profile_avatar",type:"url",name:"avatar",id:"profile-avatar",minLength:"2",required:!0,ref:t}),Object(d.jsx)("span",{className:"popup__input-error profile-avatar-error"}),Object(d.jsx)("button",{className:"button popup__submit",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var C=function(e){var t=Object(a.useState)(""),n=Object(r.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(""),o=Object(r.a)(i,2),u=o[0],l=o[1];return Object(d.jsxs)(O,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-place",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:c,link:u}),s(""),l("")},children:[Object(d.jsx)("input",{className:"popup__input popup__input_card_place",type:"text",name:"name",id:"card-title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0,onChange:function(e){s(e.target.value)},value:c}),Object(d.jsx)("span",{className:"popup__input-error card-title-error"}),Object(d.jsx)("input",{className:"popup__input popup__input_card_image",type:"url",name:"link",id:"card-image",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,onChange:function(e){l(e.target.value)},value:u}),Object(d.jsx)("span",{className:"popup__input-error card-image-error"}),Object(d.jsx)("button",{className:"button popup__submit",type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})},y=n(23),S=n(24),w=function(e){var t=e.component,n=Object(S.a)(e,["component"]);return Object(d.jsx)(p.b,{children:function(){return!0===n.loggedIn?Object(d.jsx)(t,Object(y.a)({},n)):Object(d.jsx)(p.a,{to:"./sign-up"})}})};var I=function(e){var t=Object(a.useState)(""),n=Object(r.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(""),o=Object(r.a)(i,2),u=o[0],l=o[1];return Object(d.jsxs)("section",{className:"auth",children:[Object(d.jsx)("h3",{className:"auth__title",children:"\u0412\u0445\u043e\u0434"}),Object(d.jsxs)("form",{className:"auth__form",onSubmit:function(t){t.preventDefault(),e.handleSignIn(c,u)},children:[Object(d.jsxs)("div",{className:"auth__wrapper",children:[Object(d.jsx)("input",{className:"auth__input",name:"email",type:"email",placeholder:"Email",onChange:function(e){s(e.target.value)},required:!0}),Object(d.jsx)("input",{className:"auth__input",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){l(e.target.value)},required:!0})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{className:"button button__white_theme",type:"submit",value:"\u0412\u043e\u0439\u0442\u0438"}),Object(d.jsx)("span",{className:"auth__caption"})]})]})]})};var L=function(e){var t=Object(a.useState)(""),n=Object(r.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(""),o=Object(r.a)(i,2),u=o[0],p=o[1];return Object(d.jsxs)("section",{className:"auth",children:[Object(d.jsx)("h3",{className:"auth__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(d.jsxs)("form",{className:"auth__form",onSubmit:function(t){t.preventDefault(),e.handleSignUp(c,u)},children:[Object(d.jsxs)("div",{className:"auth__wrapper",children:[Object(d.jsx)("input",{className:"auth__input",name:"email",type:"email",placeholder:"Email",onChange:function(e){s(e.target.value)},required:!0}),Object(d.jsx)("input",{className:"auth__input",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){p(e.target.value)},required:!0})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{className:"button button__white_theme",type:"submit",value:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(d.jsxs)("span",{className:"auth__caption",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0",Object(d.jsx)(l.b,{className:"link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})]})},T=new(function(){function e(t){Object(x.a)(this,e),this.url=t}return Object(g.a)(e,[{key:"_getResponseStatus",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"signUp",value:function(e,t){var n=this;return fetch("".concat(this.url,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return n._getResponseStatus(e)}))}},{key:"signIn",value:function(e,t){var n=this;return fetch("".concat(this.url,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return n._getResponseStatus(e)}))}},{key:"getToken",value:function(e){var t=this;return fetch("".concat(this.url,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return t._getResponseStatus(e)}))}}]),e}())("https://auth.nomoreparties.co"),E=n.p+"static/media/sucess.a9eb6caf.svg",P=n.p+"static/media/alert.d4ce2a26.svg";var U=function(e){return Object(d.jsx)("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_display_active"):"popup popup_type_".concat(e.name),children:Object(d.jsxs)("div",{className:"popup__window",children:[Object(d.jsx)("img",{className:"popup__info-image",src:e.isSucceed?E:P,alt:e.isSucceed?"\u0423\u0441\u043f\u0435\u0445":"\u041e\u0448\u0438\u0431\u043a\u0430"}),Object(d.jsx)("h2",{className:"popup__title",children:e.isSucceed?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."}),Object(d.jsx)("button",{className:"button button__close popup__close",type:"button",onClick:function(){e.onClose()}})]})})};var R=function(){var e=Object(a.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(!1),i=Object(r.a)(s,2),u=i[0],l=i[1],b=Object(a.useState)(!1),O=Object(r.a)(b,2),x=O[0],g=O[1],y=Object(a.useState)({isOpen:!1,name:"",link:""}),S=Object(r.a)(y,2),E=S[0],P=S[1],R=Object(a.useState)({name:"",about:"",avatar:""}),A=Object(r.a)(R,2),D=A[0],q=A[1],z=Object(a.useState)(""),J=Object(r.a)(z,2),F=J[0],B=J[1],G=Object(a.useState)({isOpen:!1,isSucceed:!1}),H=Object(r.a)(G,2),M=H[0],V=H[1],K=Object(a.useState)([]),Q=Object(r.a)(K,2),W=Q[0],X=Q[1],Y=Object(a.useState)(!1),Z=Object(r.a)(Y,2),$=Z[0],ee=Z[1],te=Object(p.g)(!0);function ne(){c(!1),l(!1),g(!1),P({isOpen:!1}),V({isOpen:!1})}return Object(a.useEffect)((function(){k.getUserInformation().then((function(e){q(e)})).catch(console.error)}),[]),Object(a.useEffect)((function(){k.getInitialCards().then((function(e){return X(e)})).catch(console.error)}),[]),Object(a.useEffect)((function(){!function(){var e=localStorage.getItem("jwt");e&&T.getToken(e).then((function(e){B(e.data.email),e&&ee(!0)})).catch(console.error)}(),$&&te.push("/")}),[te,$]),Object(d.jsxs)(h.Provider,{value:D,children:[Object(d.jsxs)("div",{className:"page",children:[Object(d.jsx)(j,{email:F,loggedIn:$,handleLogOut:function(){localStorage.removeItem("jwt"),B(""),ee(!1)}}),Object(d.jsxs)(p.d,{children:[Object(d.jsx)(w,{exact:!0,path:"/",component:_,loggedIn:$,onEditProfile:function(){l(!0)},onAddPlace:function(){g(!0)},onEditAvatar:function(){c(!0)},onCardClick:function(e){P({isOpen:!0,link:e.link,name:e.name})},cards:W,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===D._id}));k.changeLikeCardStatus(e._id,!t).then((function(t){X((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch(console.error)},onCardDelete:function(e){k.deleteCard(e._id).then((function(){X((function(t){return t.filter((function(t){return t!==e}))}))})).catch(console.error)}}),Object(d.jsx)(p.b,{path:"/sign-up",children:Object(d.jsx)(L,{handleSignUp:function(e,t){T.signUp(e,t).then((function(){te.push("/sign-in"),V({isOpen:!0,isSucceed:!0})})).catch((function(){V({isOpen:!0,isSucceed:!1})}))}})}),Object(d.jsx)(p.b,{path:"/sign-in",children:Object(d.jsx)(I,{handleSignIn:function(e,t){T.signIn(e,t).then((function(t){B(e),localStorage.setItem("jwt",t.token),ee(!0),te.push("/")})).catch((function(){V({isOpen:!0,isSucceed:!1})}))}})})]}),Object(d.jsx)(m,{}),Object(d.jsx)(N,{isOpen:n,onClose:ne,onUpdateAvatar:function(e){k.changeUserAvatar(e.avatar).then((function(e){return q(e)})).catch(console.error).finally((function(){return ne()}))}}),Object(d.jsx)(f,{isOpen:u,onClose:ne,onUpdateUser:function(e){k.saveUserInformation({name:e.name,about:e.about}).then((function(e){return q(e)})).catch(console.error).finally((function(){return ne()}))}}),Object(d.jsx)(C,{isOpen:x,onClose:ne,onAddPlace:function(e){k.addNewCard({name:e.name,link:e.link}).then((function(e){return X([e].concat(Object(o.a)(W)))})).catch(console.error).finally((function(){return ne()}))}}),Object(d.jsx)(v,{isOpen:E.isOpen,name:E.name,link:E.link,onClose:ne})]}),Object(d.jsx)(U,{isOpen:M.isOpen,onClose:ne,isSucceed:M.isSucceed})]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};i.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(l.a,{children:Object(d.jsx)(R,{})})}),document.getElementById("root")),A()}},[[36,1,2]]]);
//# sourceMappingURL=main.797c6783.chunk.js.map